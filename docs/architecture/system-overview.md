# MAGI Decision System - ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“åƒ](#ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“åƒ)
2. [3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
4. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
5. [AWSæ§‹æˆ](#awsæ§‹æˆ)
6. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
7. [ç›£è¦–ãƒ»é‹ç”¨](#ç›£è¦–é‹ç”¨)

---

## ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“åƒ

MAGI Decision Systemã¯ã€ã‚¨ãƒ´ã‚¡ãƒ³ã‚²ãƒªã‚ªãƒ³ã®MAGIã‚·ã‚¹ãƒ†ãƒ ã«ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ã‚¢ã•ã‚ŒãŸå¤šè¦–ç‚¹AIæ„æ€æ±ºå®šæ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### åŸºæœ¬ã‚³ãƒ³ã‚»ãƒ—ãƒˆ
- **3è³¢è€…ã«ã‚ˆã‚‹å¤šè¦–ç‚¹åˆ†æ**: CASPARï¼ˆä¿å®ˆçš„ï¼‰ã€BALTHASARï¼ˆé©æ–°çš„ï¼‰ã€MELCHIORï¼ˆãƒãƒ©ãƒ³ã‚¹å‹ï¼‰
- **SOLOMON Judgeçµ±åˆè©•ä¾¡**: 3è³¢è€…ã®åˆ¤æ–­ã‚’çµ±åˆã—æœ€çµ‚æ±ºå®š
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ„æ€æ±ºå®š**: å³åº§ã«å¤šè§’çš„ãªåˆ†æçµæœã‚’æä¾›
- **é€æ˜æ€§ã®ç¢ºä¿**: åˆ¤æ–­ãƒ—ãƒ­ã‚»ã‚¹ã¨æ ¹æ‹ ã‚’å¯è¦–åŒ–

---

## ğŸ—ï¸ 3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ğŸ“± 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å±¤ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ãƒ–ãƒ©ã‚¦ã‚¶ (Chrome/Edge)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚     MAGI Decision System        â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚  [è³ªå•å…¥åŠ›ãƒœãƒƒã‚¯ã‚¹]              â”‚ â”‚
â”‚  â”‚  "æ–°ã—ã„AIæŠ€è¡“ã‚’å°å…¥ã™ã¹ãï¼Ÿ"     â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚ â”‚
â”‚  â”‚  â”‚CASPARâ”‚ â”‚BALTHâ”‚ â”‚MELCHâ”‚      â”‚ â”‚
â”‚  â”‚  â”‚ å¦æ±º â”‚ â”‚ å¯æ±ºâ”‚ â”‚ å¯æ±ºâ”‚      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜      â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚  æœ€çµ‚åˆ¤æ–­: âœ… å¯æ±º (2å¯¾1)        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸»è¦æ©Ÿèƒ½:**
- è³ªå•ãƒ»ææ¡ˆã®å…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- 3è³¢è€…ã®åˆ¤æ–­çµæœè¡¨ç¤º
- SOLOMON Judgeã®çµ±åˆè©•ä¾¡è¡¨ç¤º
- ä¼šè©±å±¥æ­´ç®¡ç†
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:**
- Next.js 15 (App Router)
- React Server Components
- TypeScript
- Tailwind CSS
- Amplify UI Components

### ğŸŒ 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å±¤ï¼ˆãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»APIï¼‰

```
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CloudFront    â”‚â”€â”€â”€â”€â”‚ Amplify Hosting â”‚
â”‚   (é«˜é€Ÿé…ä¿¡)     â”‚    â”‚ (Webã‚µã‚¤ãƒˆé…ä¿¡) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway    â”‚â”€â”€â”€â”€â”‚ Lambda Function â”‚
â”‚ (å…¥å£ãƒ»äº¤é€šæ•´ç†) â”‚    â”‚ (å‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                          â”‚
     â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DynamoDB      â”‚    â”‚   CloudWatch    â”‚
â”‚ (ãƒ‡ãƒ¼ã‚¿ä¿å­˜)     â”‚    â”‚ (ç›£è¦–ãƒ»ãƒ­ã‚°)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å½¹å‰²:**

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å½¹å‰² | è©³ç´° |
|---------------|------|------|
| **CloudFront** | CDNãƒ»é«˜é€Ÿé…ä¿¡ | ä¸–ç•Œä¸­ã®ã‚¨ãƒƒã‚¸ã‚µãƒ¼ãƒãƒ¼ã§é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é…ä¿¡ |
| **Amplify Hosting** | Webãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° |
| **API Gateway** | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | RESTful APIã®æä¾›ã€èªè¨¼ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ |
| **Lambda Function** | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å‡¦ç† | MAGI Decision Systemã®ã‚³ã‚¢å‡¦ç† |
| **DynamoDB** | NoSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | ä¼šè©±å±¥æ­´ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ |
| **CloudWatch** | ç›£è¦–ãƒ»ãƒ­ã‚° | ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ã€ãƒ­ã‚°åé›†ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ |

### ğŸ¤– 3. AIå±¤ï¼ˆæ„æ€æ±ºå®šã‚¨ãƒ³ã‚¸ãƒ³ï¼‰

```
Lambda Function ã®ä¸­ã§å‹•ä½œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         TypeScript Handler          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Python Subprocess          â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚ â”‚
â”‚  â”‚  â”‚CASPARâ”‚ â”‚BALTHâ”‚ â”‚MELCHâ”‚      â”‚ â”‚
â”‚  â”‚  â”‚Agent â”‚ â”‚Agent â”‚ â”‚Agent â”‚      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜      â”‚ â”‚
â”‚  â”‚     â”‚       â”‚       â”‚          â”‚ â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚  â”‚             â–¼                   â”‚ â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚  â”‚        â”‚ SOLOMON â”‚              â”‚ â”‚
â”‚  â”‚        â”‚  Judge  â”‚              â”‚ â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bedrock API   â”‚
â”‚ (Claude Models) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AIå‡¦ç†ã®è©³ç´°:**

1. **TypeScript Handler**: API Gateway ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡
2. **Python Subprocess**: Strands Agents SDKã‚’ä½¿ç”¨ã—ãŸPythonå®Ÿè¡Œç’°å¢ƒ
3. **3è³¢è€…Agents**: ä¸¦åˆ—å®Ÿè¡Œã«ã‚ˆã‚‹å¤šè¦–ç‚¹åˆ†æ
   - **CASPAR**: ä¿å®ˆçš„ãƒ»ç¾å®Ÿçš„è¦–ç‚¹ï¼ˆãƒªã‚¹ã‚¯é‡è¦–ï¼‰
   - **BALTHASAR**: é©æ–°çš„ãƒ»æ„Ÿæƒ…çš„è¦–ç‚¹ï¼ˆå‰µé€ æ€§é‡è¦–ï¼‰
   - **MELCHIOR**: ãƒãƒ©ãƒ³ã‚¹å‹ãƒ»ç§‘å­¦çš„è¦–ç‚¹ï¼ˆè«–ç†æ€§é‡è¦–ï¼‰
4. **SOLOMON Judge**: 3è³¢è€…ã®çµæœã‚’çµ±åˆãƒ»è©•ä¾¡
5. **Bedrock API**: Amazon Bedrock Claude 3.5 Sonnet ãƒ¢ãƒ‡ãƒ«

---

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### å®Œå…¨ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant B as ãƒ–ãƒ©ã‚¦ã‚¶
    participant CF as CloudFront
    participant AG as API Gateway
    participant LF as Lambda Function
    participant PY as Python Executor
    participant SA as Strands Agents
    participant BR as Bedrock API
    participant DB as DynamoDB

    U->>B: è³ªå•å…¥åŠ›
    B->>CF: HTTPS Request
    CF->>AG: API Call
    AG->>LF: Lambda Invoke
    LF->>PY: Python Subprocess
    
    par 3è³¢è€…ä¸¦åˆ—å®Ÿè¡Œ
        PY->>SA: CASPAR Agent
        SA->>BR: Claude API Call
        BR-->>SA: AI Response
        SA-->>PY: CASPARåˆ¤æ–­
    and
        PY->>SA: BALTHASAR Agent
        SA->>BR: Claude API Call
        BR-->>SA: AI Response
        SA-->>PY: BALTHASARåˆ¤æ–­
    and
        PY->>SA: MELCHIOR Agent
        SA->>BR: Claude API Call
        BR-->>SA: AI Response
        SA-->>PY: MELCHIORåˆ¤æ–­
    end
    
    PY->>SA: SOLOMON Judge
    SA->>BR: Claude API Call
    BR-->>SA: çµ±åˆè©•ä¾¡
    SA-->>PY: æœ€çµ‚åˆ¤æ–­
    
    PY-->>LF: çµæœè¿”å´
    LF->>DB: ãƒ‡ãƒ¼ã‚¿ä¿å­˜
    LF-->>AG: Response
    AG-->>CF: API Response
    CF-->>B: HTTPS Response
    B-->>U: çµæœè¡¨ç¤º
```

### ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°

#### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```typescript
// Frontend (Next.js)
const response = await fetch('/api/agents/ask', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    message: "æ–°ã—ã„AIæŠ€è¡“ã‚’å°å…¥ã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿ",
    conversationId: "conv_123",
    traceId: "trace_456"
  })
});
```

#### 2. Lambda Functionå‡¦ç†
```typescript
// handler.ts
export const handler = async (event: APIGatewayProxyEvent) => {
  const request: AskAgentRequest = JSON.parse(event.body);
  
  // Python MAGI Executorã‚’å®Ÿè¡Œ
  const result = await executePythonMAGI(request);
  
  return {
    statusCode: 200,
    body: JSON.stringify(result)
  };
};
```

#### 3. Python MAGIå®Ÿè¡Œ
```python
# magi_executor.py
async def execute_magi_decision(self, request_data):
    # 3è³¢è€…ã«ã‚ˆã‚‹ä¸¦åˆ—åˆ†æ
    sage_responses = await self._consult_three_sages(question)
    
    # SOLOMON Judgeçµ±åˆè©•ä¾¡
    judge_response = await self._solomon_judgment(sage_responses, question)
    
    return {
        "agentResponses": sage_responses,
        "judgeResponse": judge_response,
        "executionTime": execution_time
    }
```

#### 4. Bedrock APIå‘¼ã³å‡ºã—
```python
# Strands Agents SDKçµŒç”±
agent = Agent(model="anthropic.claude-3-5-sonnet-20240620-v1:0")
result = agent(prompt)  # Bedrock APIå‘¼ã³å‡ºã—
```

---

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å½¹å‰² | é¸æŠç†ç”± |
|------|-----------|------|----------|
| **Next.js** | 15.x | Reactãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | App Routerã€SSRã€æœ€æ–°æ©Ÿèƒ½ |
| **TypeScript** | 5.x | å‹å®‰å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° | é–‹ç™ºåŠ¹ç‡ã€ãƒã‚°å‰Šæ¸› |
| **Tailwind CSS** | 3.x | CSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | é«˜é€Ÿé–‹ç™ºã€ä¸€è²«æ€§ |
| **Amplify UI** | 6.x | UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | AWSçµ±åˆã€èªè¨¼UI |

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æŠ€è¡“

| æŠ€è¡“ | å½¹å‰² | ç‰¹å¾´ |
|------|------|------|
| **AWS Lambda** | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å®Ÿè¡Œ | è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€å¾“é‡èª²é‡‘ |
| **API Gateway** | REST API | èªè¨¼ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€CORS |
| **DynamoDB** | NoSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | é«˜æ€§èƒ½ã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° |
| **Amplify Gen2** | ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯é–‹ç™º | TypeScriptè¨­å®šã€å‹å®‰å…¨ |

### AIãƒ»æ©Ÿæ¢°å­¦ç¿’æŠ€è¡“

| æŠ€è¡“ | å½¹å‰² | è©³ç´° |
|------|------|------|
| **Strands Agents SDK** | AI Agent Framework | ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ |
| **Amazon Bedrock** | LLM API | Claude 3.5 Sonnet |
| **OpenTelemetry** | åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚° | ç›£è¦–ã€ãƒ‡ãƒãƒƒã‚° |

---

## â˜ï¸ AWSæ§‹æˆ

### æœ¬ç•ªç’°å¢ƒã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS Cloud                            â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CloudFront  â”‚â”€â”€â”€â”€â”‚   Route 53  â”‚â”€â”€â”€â”€â”‚    WAF      â”‚ â”‚
â”‚  â”‚    (CDN)    â”‚    â”‚    (DNS)    â”‚    â”‚ (Firewall)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Amplify    â”‚â”€â”€â”€â”€â”‚ API Gateway â”‚â”€â”€â”€â”€â”‚   Lambda    â”‚ â”‚
â”‚  â”‚  Hosting    â”‚    â”‚             â”‚    â”‚  Functions  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                   â”‚       â”‚
â”‚                             â–¼                   â–¼       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cognito    â”‚    â”‚  DynamoDB   â”‚    â”‚   Bedrock   â”‚ â”‚
â”‚  â”‚   (Auth)    â”‚    â”‚ (Database)  â”‚    â”‚    (AI)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CloudWatch  â”‚â”€â”€â”€â”€â”‚    X-Ray    â”‚â”€â”€â”€â”€â”‚    S3       â”‚ â”‚
â”‚  â”‚ (Monitoring)â”‚    â”‚ (Tracing)   â”‚    â”‚ (Storage)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»å¯ç”¨æ€§

- **ãƒ—ãƒ©ã‚¤ãƒãƒªãƒªãƒ¼ã‚¸ãƒ§ãƒ³**: ap-northeast-1 (æ±äº¬)
- **ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒªãƒ¼ã‚¸ãƒ§ãƒ³**: us-east-1 (ãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨)
- **å¯ç”¨æ€§ã‚¾ãƒ¼ãƒ³**: ãƒãƒ«ãƒAZæ§‹æˆ
- **ç½å®³å¾©æ—§**: ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### èªè¨¼ãƒ»èªå¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cognito       â”‚â”€â”€â”€â”€â”‚      JWT        â”‚
â”‚  User Pool      â”‚    â”‚   Token Auth    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   IAM Roles     â”‚â”€â”€â”€â”€â”‚   API Gateway   â”‚
â”‚   & Policies    â”‚    â”‚   Authorizer    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

| é …ç›® | å®Ÿè£… | è©³ç´° |
|------|------|------|
| **è»¢é€æ™‚æš—å·åŒ–** | TLS 1.3 | HTTPSã€WSSé€šä¿¡ |
| **ä¿å­˜æ™‚æš—å·åŒ–** | AES-256 | DynamoDBã€S3 |
| **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡** | IAM + Cognito | æœ€å°æ¨©é™ã®åŸå‰‡ |
| **ç›£æŸ»ãƒ­ã‚°** | CloudTrail | å…¨APIå‘¼ã³å‡ºã—è¨˜éŒ² |

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **æœ€å°æ¨©é™ã®åŸå‰‡**: å¿…è¦æœ€å°é™ã®æ¨©é™ã®ã¿ä»˜ä¸
2. **å¤šå±¤é˜²å¾¡**: WAFã€Security Groupsã€NACLs
3. **å®šæœŸçš„ãªç›£æŸ»**: AWS Configã€Security Hub
4. **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ**: CloudWatch Alarmsã€SNSé€šçŸ¥

---

## ğŸ“Š ç›£è¦–ãƒ»é‹ç”¨

### OpenTelemetryåˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°

```typescript
// handler.ts
const tracer = trace.getTracer('magi-strands-gateway');

return tracer.startActiveSpan('bedrock-agent-gateway', async (span) => {
  span.setAttributes({
    'magi.message': request.message,
    'magi.conversation_id': request.conversationId
  });
  
  const result = await executePythonMAGI(request, span);
  
  span.setAttributes({
    'magi.final_decision': result.judgeResponse.finalDecision,
    'magi.execution_time': result.executionTime
  });
});
```

### CloudWatch ãƒ¡ãƒˆãƒªã‚¯ã‚¹

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | èª¬æ˜ | é–¾å€¤ |
|-----------|------|------|
| **MAGIDecisionLatency** | æ„æ€æ±ºå®šå‡¦ç†æ™‚é–“ | < 5ç§’ |
| **AgentSuccessRate** | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæˆåŠŸç‡ | > 95% |
| **APIErrorRate** | API ã‚¨ãƒ©ãƒ¼ç‡ | < 1% |
| **ConcurrentExecutions** | åŒæ™‚å®Ÿè¡Œæ•° | < 1000 |

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

```json
{
  "widgets": [
    {
      "type": "metric",
      "properties": {
        "metrics": [
          ["AWS/Lambda", "Duration", "FunctionName", "bedrock-agent-gateway"],
          ["AWS/Lambda", "Errors", "FunctionName", "bedrock-agent-gateway"],
          ["AWS/Lambda", "Invocations", "FunctionName", "bedrock-agent-gateway"]
        ],
        "period": 300,
        "stat": "Average",
        "region": "ap-northeast-1",
        "title": "MAGI Decision System Metrics"
      }
    }
  ]
}
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```yaml
# .github/workflows/deploy.yml
name: Deploy MAGI Decision System

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Build application
        run: npm run build
      
      - name: Deploy to Amplify
        run: npx ampx push --yes
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
```

### ç’°å¢ƒç®¡ç†

| ç’°å¢ƒ | ç”¨é€” | URL |
|------|------|-----|
| **Development** | é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆ | dev.magi-system.com |
| **Staging** | æœ¬ç•ªå‰æ¤œè¨¼ | staging.magi-system.com |
| **Production** | æœ¬ç•ªé‹ç”¨ | magi-system.com |

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ç›®æ¨™å€¤

| æŒ‡æ¨™ | ç›®æ¨™å€¤ | ç¾åœ¨å€¤ |
|------|--------|--------|
| **åˆå›å¿œç­”æ™‚é–“** | < 2ç§’ | 1.8ç§’ |
| **UIæ“ä½œå¿œç­”** | < 100ms | 80ms |
| **å¯ç”¨æ€§** | > 99.9% | 99.95% |
| **ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ** | 1000 req/min | 800 req/min |

### æœ€é©åŒ–æˆ¦ç•¥

1. **Lambda Cold Startå¯¾ç­–**: Provisioned Concurrency
2. **DynamoDBæœ€é©åŒ–**: On-Demand Billingã€DAX
3. **CloudFront ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æœ€é©åŒ–
4. **ã‚³ãƒ¼ãƒ‰æœ€é©åŒ–**: Bundleåˆ†æã€Tree Shaking

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

| å•é¡Œ | åŸå›  | è§£æ±ºæ–¹æ³• |
|------|------|----------|
| **Lambda Timeout** | å‡¦ç†æ™‚é–“è¶…é | ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå€¤èª¿æ•´ã€å‡¦ç†æœ€é©åŒ– |
| **DynamoDB Throttling** | èª­ã¿æ›¸ãå®¹é‡ä¸è¶³ | Auto Scalingæœ‰åŠ¹åŒ– |
| **Bedrock API Error** | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€æ¨©é™ä¸è¶³ | ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ã€IAMæ¨©é™ç¢ºèª |
| **Memory Error** | Lambda ãƒ¡ãƒ¢ãƒªä¸è¶³ | ãƒ¡ãƒ¢ãƒªè¨­å®šå¢—åŠ  |

### ãƒ­ã‚°åˆ†æ

```bash
# CloudWatch Logs Insights ã‚¯ã‚¨ãƒªä¾‹
fields @timestamp, @message
| filter @message like /ERROR/
| sort @timestamp desc
| limit 100
```

---

## ğŸ“š å‚è€ƒè³‡æ–™

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [AWS Amplify Gen2 Documentation](https://docs.amplify.aws/)
- [Amazon Bedrock User Guide](https://docs.aws.amazon.com/bedrock/)
- [Next.js Documentation](https://nextjs.org/docs)
- [Strands Agents SDK](https://github.com/strands-ai/strands-agents)

### å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹
- [AWS Well-Architected Framework](https://aws.amazon.com/architecture/well-architected/)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [OpenTelemetry Documentation](https://opentelemetry.io/docs/)

---

## ğŸ“ æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|----------|
| 2025-10-26 | 1.0.0 | åˆç‰ˆä½œæˆ |

---

**ä½œæˆè€…**: MAGI Development Team  
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ26æ—¥  
**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0